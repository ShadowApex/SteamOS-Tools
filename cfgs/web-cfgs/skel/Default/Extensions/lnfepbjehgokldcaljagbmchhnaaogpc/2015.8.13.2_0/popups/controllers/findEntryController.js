/*! CKP - KeePass integration for Chromeâ„¢, Copyright 2015 Steven Campbell
*/
"use strict";function FindEntryController($scope,unlockedState,secureCache){function createEntryFilters(entries){entries.forEach(function(entry){var filters=new Array;collectFilters(entry,filters),entry.filterKey=filters.join(" ")})}function collectFilters(data,collector){if(null===data||void 0===data)return data;if(data.constructor==ArrayBuffer||data.constructor==Uint8Array)return null;if("string"==typeof data)collector.push(data.toLocaleLowerCase());else if(data.constructor==Array)for(var i=0;i<data.length;i++)collectFilters(data[i],collector);else for(var prop in data)collectFilters(data[prop],collector)}$scope.filter="",$scope.unlockedState=unlockedState,secureCache.get("entries").then(function(entries){unlockedState.entries=entries,$scope.allEntries=entries,createEntryFilters(entries),$scope.$apply()}),secureCache.get("streamKey").then(function(streamKey){unlockedState.streamKey=streamKey}),$scope.filterKey=function(){if(!$scope.filter)return void(unlockedState.entries=$scope.allEntries);var filter=$scope.filter.toLocaleLowerCase();unlockedState.entries=$scope.allEntries.filter(function(entry){return entry.filterKey.indexOf(filter)>-1})}}