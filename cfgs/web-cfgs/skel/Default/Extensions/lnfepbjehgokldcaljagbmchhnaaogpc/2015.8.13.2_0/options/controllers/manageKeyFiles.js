/*! CKP - KeePass integration for Chromeâ„¢, Copyright 2015 Steven Campbell
*/
"use strict";function ManageKeyFilesController($scope,settings,keyFileParser){function loadKeyFiles(){settings.getKeyFiles().then(function(files){$scope.$apply(function(){$scope.keyFiles=files})})}loadKeyFiles(),$scope.removeKeyFile=function(keyFile){settings.deleteKeyFile(keyFile.name).then(function(){loadKeyFiles()})},$scope.selectFile=function(){document.getElementById("file").click()},$scope.handleKeyFile=function(filePromises){$scope.errorMessage="",1==filePromises.length&&filePromises[0].then(function(info){return keyFileParser.getKeyFromFile(info.data).then(function(key){return settings.addKeyFile(info.file.name,key)}).then(function(){loadKeyFiles()})})["catch"](function(err){$scope.errorMessage=err.message,$scope.$apply()})}}