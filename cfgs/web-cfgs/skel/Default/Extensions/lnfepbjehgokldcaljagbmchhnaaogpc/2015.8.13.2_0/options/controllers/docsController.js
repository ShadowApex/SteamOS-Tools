/*! CKP - KeePass integration for Chromeâ„¢, Copyright 2015 Steven Campbell
*/
function DocsController($scope,googleDrivePasswordFileManager){"use strict";$scope.docs=[],$scope.refresh=function(){$scope.docs=[],$scope.refreshing=!0,$scope.errorMessage="",googleDrivePasswordFileManager.interactiveRequestAuth().then(function(){return googleDrivePasswordFileManager.listDatabases()}).then(function(docs){$scope.docs=docs,$scope.errorMessage=""})["catch"](function(err){$scope.errorMessage=err.message||"Unknown Error"}).then(function(){$scope.refreshing=!1,$scope.$apply()})},$scope.authorize=function(){$scope.refreshing=!0,$scope.errorMessage="",$scope.requestingUrl=!0,googleDrivePasswordFileManager.ensureGoogleUrlPermissions().then(function(){return $scope.requestingUrl=!1,$scope.requestingDriveAccess=!0,$scope.$apply(),googleDrivePasswordFileManager.interactiveRequestAuth()}).then(function(){return $scope.requestingDriveAccess=!1,$scope.$apply(),googleDrivePasswordFileManager.listDatabases()}).then(function(docs){$scope.docs=docs})["catch"](function(err){$scope.errorMessage=err.message||"Error authorizing"}).then(function(){$scope.requestingUrl=!1,$scope.requestingDriveAccess=!1,$scope.refreshing=!1,$scope.$apply()})},$scope.logout=function(){$scope.errorMessage="",googleDrivePasswordFileManager.revokeAuth().then(function(){$scope.$apply()})},$scope.authorized=function(){return googleDrivePasswordFileManager.isAuthorized()},$scope.refreshing=!0,googleDrivePasswordFileManager.listDatabases().then(function(docs){$scope.docs=docs})["catch"](function(){$scope.errorMessage=""}).then(function(){$scope.refreshing=!1,$scope.$apply()})}